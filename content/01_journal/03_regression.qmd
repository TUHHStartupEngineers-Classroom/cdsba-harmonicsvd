

library(tidyverse)

car_prices<- readRDS("car_prices.rds")


# Check dimensions
dim(car_prices)

# Get a detailed look at the data
str(car_prices)

# Summary statistics for numeric variables
summary(car_prices)

# Running a linear regression to explain car pricing
lm_model <- lm(price ~ ., data = car_prices)

summary(lm_model)

#choosing one regressor
regressor <- car_prices$horsepower

# Data type and values
typeof(regressor)
unique(regressor)

# Effect on price
# Assuming 'price' is the dependent variable in the regression
coef_table <- coef(lm_model)
effect_on_price <- coef_table["horsepower"]

# Statistical significance
p_value <- lm_model$Coefficients["horsepower", "Pr(>|t|)"]

# Print results
cat("Regressor (horsepower) data type:", typeof(regressor))
cat("Regressor (horsepower) values:", unique(regressor))
cat("Effect on price:", effect_on_price)
cat("Statistical significance (p-value):", p_value)

#adding one variable
car_prices_with_seat_heating <- car_prices %>%
mutate(seat_heating = TRUE)

# Runnig regression with the new variable
lm_model_with_seat_heating <- lm(price ~ ., data = car_prices_with_seat_heating)

# Displaying regression summary with the new variable
summary(lm_model_with_seat_heating)




