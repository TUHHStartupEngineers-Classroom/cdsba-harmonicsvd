{
  "hash": "5e1465af6ded3a08a9d666efd993131e",
  "result": {
    "markdown": "::: {.cell hash='08_did_cache/html/unnamed-chunk-1_5067035bb38855873f9c3ede32203d99'}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(tidyverse)\n\n# Load the data\ndata <- readRDS(\"hospdd.rds\")\n\n# Explore the structure of the dataset\nstr(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [7,368 × 5] (S3: tbl_df/tbl/data.frame)\n#>  $ hospital : num [1:7368] 1 1 1 1 1 1 1 1 1 1 ...\n#>   ..- attr(*, \"label\")= chr \"Hospital ID\"\n#>   ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n#>  $ frequency: 'int' num [1:7368] 3 2 4 2 1 1 2 4 2 2 ...\n#>   ..- attr(*, \"label\")= chr \"Hospital visit frequency\"\n#>   ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n#>   ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n#>   .. ..- attr(*, \"names\")= chr [1:4] \"Low\" \"Medium\" \"High\" \"Very high\"\n#>  $ month    : 'int' num [1:7368] 7 3 2 4 3 7 4 1 3 1 ...\n#>   ..- attr(*, \"label\")= chr \"Month\"\n#>   ..- attr(*, \"format.stata\")= chr \"%8.0g\"\n#>   ..- attr(*, \"labels\")= Named num [1:7] 1 2 3 4 5 6 7\n#>   .. ..- attr(*, \"names\")= chr [1:7] \"January\" \"February\" \"March\" \"April\" ...\n#>  $ procedure: 'dbl' num [1:7368] 1 0 0 1 0 1 1 0 0 0 ...\n#>   ..- attr(*, \"label\")= chr \"Admission procedure\"\n#>   ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n#>   ..- attr(*, \"labels\")= Named num [1:2] 0 1\n#>   .. ..- attr(*, \"names\")= chr [1:2] \"Old\" \"New\"\n#>  $ satis    : num [1:7368] 4.11 3.32 3.41 3 3.11 ...\n#>   ..- attr(*, \"label\")= chr \"Patient satisfaction score\"\n#>   ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n#>  - attr(*, \"label\")= chr \"Artificial hospital admission procedure data\"\n```\n:::\n\n```{.r .cell-code}\nmean_satisfaction <- data %>%\n  group_by(procedure, month) %>%\n  summarize(mean_satisfaction = mean(satis))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'procedure'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# Print the computed means\nprint(mean_satisfaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 11 × 3\n#> # Groups:   procedure [2]\n#>    procedure month mean_satisfaction\n#>    <dbl>     <int>             <dbl>\n#>  1 0         1                  3.44\n#>  2 0         2                  3.44\n#>  3 0         3                  3.47\n#>  4 0         4                  3.40\n#>  5 0         5                  3.36\n#>  6 0         6                  3.39\n#>  7 0         7                  3.37\n#>  8 1         4                  4.34\n#>  9 1         5                  4.38\n#> 10 1         6                  4.35\n#> 11 1         7                  4.38\n```\n:::\n\n```{.r .cell-code}\n# Option 1: Using month + hospital\nmodel1 <- lm(satis ~ procedure * month + factor(hospital), data = data)\n\n# Option 2: Using as.factor(month) + as.factor(hospital)\nmodel2 <- lm(satis ~ procedure * as.factor(month) + as.factor(hospital), data = data)\n\n# Print the summary of the regression models\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure * month + factor(hospital), data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.1926 -0.4642  0.0066  0.4542  4.3076 \n#> \n#> Coefficients:\n#>                     Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)         3.178254   0.055642  57.120  < 2e-16 ***\n#> procedure           0.791153   0.095055   8.323  < 2e-16 ***\n#> month              -0.002004   0.005073  -0.395 0.692765    \n#> factor(hospital)2   0.408566   0.077225   5.291 1.25e-07 ***\n#> factor(hospital)3   0.533625   0.079321   6.727 1.86e-11 ***\n#> factor(hospital)4   0.227510   0.073925   3.078 0.002095 ** \n#> factor(hospital)5  -0.145353   0.073925  -1.966 0.049311 *  \n#> factor(hospital)6   0.447863   0.073925   6.058 1.44e-09 ***\n#> factor(hospital)7   1.404416   0.071441  19.659  < 2e-16 ***\n#> factor(hospital)8   0.071876   0.076302   0.942 0.346230    \n#> factor(hospital)9  -1.518515   0.078228 -19.411  < 2e-16 ***\n#> factor(hospital)10  1.682845   0.077225  21.791  < 2e-16 ***\n#> factor(hospital)11  0.220965   0.076302   2.896 0.003792 ** \n#> factor(hospital)12 -0.095303   0.078228  -1.218 0.223157    \n#> factor(hospital)13  0.495593   0.075450   6.569 5.43e-11 ***\n#> factor(hospital)14  0.233043   0.079321   2.938 0.003314 ** \n#> factor(hospital)15 -0.144494   0.079321  -1.822 0.068553 .  \n#> factor(hospital)16  1.414268   0.077225  18.314  < 2e-16 ***\n#> factor(hospital)17  0.423543   0.080519   5.260 1.48e-07 ***\n#> factor(hospital)18  0.153276   0.093796   1.634 0.102272    \n#> factor(hospital)19 -0.746554   0.080952  -9.222  < 2e-16 ***\n#> factor(hospital)20  0.046136   0.078899   0.585 0.558741    \n#> factor(hospital)21  1.193085   0.083418  14.302  < 2e-16 ***\n#> factor(hospital)22  0.798063   0.082126   9.718  < 2e-16 ***\n#> factor(hospital)23  0.700468   0.080952   8.653  < 2e-16 ***\n#> factor(hospital)24 -0.309378   0.086441  -3.579 0.000347 ***\n#> factor(hospital)25  0.645222   0.092537   6.973 3.38e-12 ***\n#> factor(hospital)26  0.212995   0.078899   2.700 0.006959 ** \n#> factor(hospital)27 -0.399906   0.076390  -5.235 1.70e-07 ***\n#> factor(hospital)28  0.710743   0.083418   8.520  < 2e-16 ***\n#> factor(hospital)29  0.247299   0.079881   3.096 0.001970 ** \n#> factor(hospital)30 -0.169174   0.095179  -1.777 0.075540 .  \n#> factor(hospital)31  0.510833   0.078899   6.474 1.01e-10 ***\n#> factor(hospital)32 -0.324598   0.079881  -4.064 4.88e-05 ***\n#> factor(hospital)33 -0.455227   0.078899  -5.770 8.26e-09 ***\n#> factor(hospital)34 -0.001664   0.074380  -0.022 0.982149    \n#> factor(hospital)35  0.352859   0.076390   4.619 3.92e-06 ***\n#> factor(hospital)36  2.136891   0.077162  27.693  < 2e-16 ***\n#> factor(hospital)37  0.139152   0.092537   1.504 0.132693    \n#> factor(hospital)38 -0.088058   0.077996  -1.129 0.258934    \n#> factor(hospital)39 -0.024749   0.082126  -0.301 0.763155    \n#> factor(hospital)40  1.120281   0.077996  14.363  < 2e-16 ***\n#> factor(hospital)41 -0.150986   0.076390  -1.977 0.048133 *  \n#> factor(hospital)42  0.879885   0.084849  10.370  < 2e-16 ***\n#> factor(hospital)43 -0.773684   0.080952  -9.557  < 2e-16 ***\n#> factor(hospital)44  0.033160   0.090241   0.367 0.713286    \n#> factor(hospital)45 -0.215001   0.076390  -2.815 0.004898 ** \n#> factor(hospital)46  0.077240   0.082126   0.941 0.346992    \n#> procedure:month     0.009878   0.017298   0.571 0.567967    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.7237 on 7319 degrees of freedom\n#> Multiple R-squared:  0.5332,\tAdjusted R-squared:  0.5301 \n#> F-statistic: 174.2 on 48 and 7319 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure * as.factor(month) + as.factor(hospital), \n#>     data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.1880 -0.4630  0.0024  0.4540  4.3181 \n#> \n#> Coefficients: (3 not defined because of singularities)\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                  3.1716566  0.0562244  56.411  < 2e-16 ***\n#> procedure                    0.8785070  0.0541087  16.236  < 2e-16 ***\n#> as.factor(month)2           -0.0096077  0.0292138  -0.329 0.742261    \n#> as.factor(month)3            0.0219686  0.0292138   0.752 0.452080    \n#> as.factor(month)4            0.0152441  0.0368748   0.413 0.679326    \n#> as.factor(month)5           -0.0246564  0.0368748  -0.669 0.503740    \n#> as.factor(month)6            0.0055796  0.0368748   0.151 0.879734    \n#> as.factor(month)7           -0.0238856  0.0368748  -0.648 0.517169    \n#> as.factor(hospital)2         0.4085664  0.0772468   5.289 1.26e-07 ***\n#> as.factor(hospital)3         0.5336248  0.0793436   6.725 1.88e-11 ***\n#> as.factor(hospital)4         0.2275102  0.0739460   3.077 0.002101 ** \n#> as.factor(hospital)5        -0.1453529  0.0739460  -1.966 0.049375 *  \n#> as.factor(hospital)6         0.4478634  0.0739460   6.057 1.46e-09 ***\n#> as.factor(hospital)7         1.4044164  0.0714606  19.653  < 2e-16 ***\n#> as.factor(hospital)8         0.0718758  0.0763236   0.942 0.346365    \n#> as.factor(hospital)9        -1.5185150  0.0782498 -19.406  < 2e-16 ***\n#> as.factor(hospital)10        1.6828446  0.0772468  21.785  < 2e-16 ***\n#> as.factor(hospital)11        0.2209653  0.0763236   2.895 0.003801 ** \n#> as.factor(hospital)12       -0.0953034  0.0782498  -1.218 0.223287    \n#> as.factor(hospital)13        0.4955931  0.0754708   6.567 5.50e-11 ***\n#> as.factor(hospital)14        0.2330426  0.0793436   2.937 0.003323 ** \n#> as.factor(hospital)15       -0.1444935  0.0793436  -1.821 0.068631 .  \n#> as.factor(hospital)16        1.4142680  0.0772468  18.308  < 2e-16 ***\n#> as.factor(hospital)17        0.4235429  0.0805415   5.259 1.49e-07 ***\n#> as.factor(hospital)18        0.1532761  0.0938225   1.634 0.102369    \n#> as.factor(hospital)19       -0.7453017  0.0811676  -9.182  < 2e-16 ***\n#> as.factor(hospital)20        0.0473874  0.0791192   0.599 0.549234    \n#> as.factor(hospital)21        1.1943370  0.0836287  14.281  < 2e-16 ***\n#> as.factor(hospital)22        0.7993153  0.0823390   9.708  < 2e-16 ***\n#> as.factor(hospital)23        0.7017202  0.0811676   8.645  < 2e-16 ***\n#> as.factor(hospital)24       -0.3081260  0.0866459  -3.556 0.000379 ***\n#> as.factor(hospital)25        0.6464736  0.0927319   6.971 3.41e-12 ***\n#> as.factor(hospital)26        0.2142471  0.0791192   2.708 0.006787 ** \n#> as.factor(hospital)27       -0.3986544  0.0766156  -5.203 2.01e-07 ***\n#> as.factor(hospital)28        0.7119953  0.0836287   8.514  < 2e-16 ***\n#> as.factor(hospital)29        0.2485512  0.0800987   3.103 0.001923 ** \n#> as.factor(hospital)30       -0.1679220  0.0953700  -1.761 0.078324 .  \n#> as.factor(hospital)31        0.5120848  0.0791192   6.472 1.03e-10 ***\n#> as.factor(hospital)32       -0.3233456  0.0800987  -4.037 5.47e-05 ***\n#> as.factor(hospital)33       -0.4539752  0.0791192  -5.738 9.97e-09 ***\n#> as.factor(hospital)34       -0.0004123  0.0746103  -0.006 0.995591    \n#> as.factor(hospital)35        0.3541110  0.0766156   4.622 3.87e-06 ***\n#> as.factor(hospital)36        2.1381425  0.0773862  27.630  < 2e-16 ***\n#> as.factor(hospital)37        0.1404036  0.0927319   1.514 0.130049    \n#> as.factor(hospital)38       -0.0868060  0.0782181  -1.110 0.267124    \n#> as.factor(hospital)39       -0.0234969  0.0823390  -0.285 0.775370    \n#> as.factor(hospital)40        1.1215331  0.0782181  14.339  < 2e-16 ***\n#> as.factor(hospital)41       -0.1497346  0.0766156  -1.954 0.050697 .  \n#> as.factor(hospital)42        0.8811369  0.0850564  10.359  < 2e-16 ***\n#> as.factor(hospital)43       -0.7724325  0.0811676  -9.517  < 2e-16 ***\n#> as.factor(hospital)44        0.0344120  0.0904396   0.380 0.703588    \n#> as.factor(hospital)45       -0.2137495  0.0766156  -2.790 0.005286 ** \n#> as.factor(hospital)46        0.0784915  0.0823390   0.953 0.340484    \n#> procedure:as.factor(month)2         NA         NA      NA       NA    \n#> procedure:as.factor(month)3         NA         NA      NA       NA    \n#> procedure:as.factor(month)4 -0.0750732  0.0684427  -1.097 0.272731    \n#> procedure:as.factor(month)5  0.0061613  0.0684427   0.090 0.928272    \n#> procedure:as.factor(month)6 -0.0531645  0.0684427  -0.777 0.437317    \n#> procedure:as.factor(month)7         NA         NA      NA       NA    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.7239 on 7312 degrees of freedom\n#> Multiple R-squared:  0.5334,\tAdjusted R-squared:  0.5299 \n#> F-statistic:   152 on 55 and 7312 DF,  p-value: < 2.2e-16\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}