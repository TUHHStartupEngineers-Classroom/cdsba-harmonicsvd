{
  "hash": "29aafebd2f224efa17a5fc7efab42013",
  "result": {
    "markdown": "::: {.cell hash='10_rdd_cache/html/unnamed-chunk-1_f5596b563bc64503536d009da895c054'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# Load data\ncoupon_data <- readRDS(\"coupon.rds\")\n\n\nshipping_data <- readRDS(\"shipping.rds\")\n\n# Explore the structure of the shipping dataset\nstr(shipping_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [6,666 Ã— 1] (S3: tbl_df/tbl/data.frame)\n#>  $ purchase_amount: num [1:6666] 13.11 37.12 11.26 9.45 53.24 ...\n```\n:::\n\n```{.r .cell-code}\nggplot(shipping_data, aes(x = purchase_amount)) +\n  geom_histogram(binwidth = 5, fill = \"skyblue\", color = \"black\") +\n  labs(title = \"Distribution of Purchase Amount\", x = \"Purchase Amount\", y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](10_rdd_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nrd_analysis <- function(data, bandwidth) {\n  model <- lm(purchase_after ~ as.numeric(days_since_last_centered) + factor(coupon),\n               data = data %>% filter(abs(days_since_last_centered) <= bandwidth))\n  summary(model)\n}\n\n# Run the analysis with different bandwidths\noriginal_result <- rd_analysis(coupon_data, bandwidth = 20)\nhalf_bandwidth_result <- rd_analysis(coupon_data, bandwidth = 10)\ndouble_bandwidth_result <- rd_analysis(coupon_data, bandwidth = 40)\n\n# Print the results\nprint(\"Original Bandwidth:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Original Bandwidth:\"\n```\n:::\n\n```{.r .cell-code}\nprint(original_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_after ~ as.numeric(days_since_last_centered) + \n#>     factor(coupon), data = data %>% filter(abs(days_since_last_centered) <= \n#>     bandwidth))\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -12.4179  -1.9502   0.0212   2.0024  10.5355 \n#> \n#> Coefficients:\n#>                                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                          10.71917    0.19051  56.265   <2e-16 ***\n#> as.numeric(days_since_last_centered)  0.01172    0.01432   0.819    0.413    \n#> factor(coupon)TRUE                    9.55974    0.33615  28.439   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3.039 on 1346 degrees of freedom\n#> Multiple R-squared:  0.7108,\tAdjusted R-squared:  0.7104 \n#> F-statistic:  1654 on 2 and 1346 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nprint(\"Half Bandwidth:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Half Bandwidth:\"\n```\n:::\n\n```{.r .cell-code}\nprint(half_bandwidth_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_after ~ as.numeric(days_since_last_centered) + \n#>     factor(coupon), data = data %>% filter(abs(days_since_last_centered) <= \n#>     bandwidth))\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -12.2718  -2.0858  -0.0003   2.0275  10.6749 \n#> \n#> Coefficients:\n#>                                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                          10.61700    0.27386  38.767   <2e-16 ***\n#> as.numeric(days_since_last_centered)  0.01413    0.04255   0.332     0.74    \n#> factor(coupon)TRUE                    9.51584    0.48628  19.569   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3.115 on 626 degrees of freedom\n#> Multiple R-squared:  0.7052,\tAdjusted R-squared:  0.7042 \n#> F-statistic: 748.6 on 2 and 626 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nprint(\"Double Bandwidth:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Double Bandwidth:\"\n```\n:::\n\n```{.r .cell-code}\nprint(double_bandwidth_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_after ~ as.numeric(days_since_last_centered) + \n#>     factor(coupon), data = data %>% filter(abs(days_since_last_centered) <= \n#>     bandwidth))\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -12.8107  -2.0463   0.0325   2.0652  10.2290 \n#> \n#> Coefficients:\n#>                                       Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                          10.433486   0.132361  78.826  < 2e-16 ***\n#> as.numeric(days_since_last_centered) -0.019087   0.004998  -3.819 0.000137 ***\n#> factor(coupon)TRUE                   10.238246   0.233588  43.830  < 2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3.028 on 2940 degrees of freedom\n#> Multiple R-squared:  0.666,\tAdjusted R-squared:  0.6658 \n#> F-statistic:  2931 on 2 and 2940 DF,  p-value: < 2.2e-16\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}