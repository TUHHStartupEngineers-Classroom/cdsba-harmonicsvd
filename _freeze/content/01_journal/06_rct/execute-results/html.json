{
  "hash": "687910535682b0e7deeeab971f532ea4",
  "result": {
    "markdown": "::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_3a1e82d9bc82147774b1757db552afb7'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(ggplot2)\n\n\nabtest_data <- readRDS(\"abtest_online.rds\")\n\n\nstr(abtest_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [1,000 × 6] (S3: tbl_df/tbl/data.frame)\n#>  $ ip             : chr [1:1000] \"161.88.211.70\" \"239.86.201.0\" \"35.90.22.130\" \"219.176.193.3\" ...\n#>  $ chatbot        : logi [1:1000] TRUE TRUE TRUE FALSE TRUE TRUE ...\n#>  $ previous_visit : num [1:1000] 0 1 1 4 1 2 1 1 1 0 ...\n#>  $ mobile_device  : logi [1:1000] FALSE FALSE FALSE TRUE FALSE FALSE ...\n#>  $ purchase       : num [1:1000] 0 1 0 0 0 0 1 1 0 0 ...\n#>  $ purchase_amount: num [1:1000] 0 39.5 0 0 0 ...\n```\n:::\n\n```{.r .cell-code}\nggplot(abtest_data, aes(x = chatbot, y = previous_visit)) +\n  geom_boxplot() +\n  labs(title = \"Balance Check: Covariates Across Groups\", x = \"Chatbot\", y = \"Previous Visits\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nreg_model <- lm(purchase_amount ~ chatbot + mobile_device + previous_visit, data = abtest_data)\n\n\nsummary(reg_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot + mobile_device + previous_visit, \n#>     data = abtest_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -25.414 -14.428  -8.435  12.559  64.584 \n#> \n#> Coefficients:\n#>                   Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)        15.2840     1.1227  13.614  < 2e-16 ***\n#> chatbotTRUE        -6.8488     1.1792  -5.808 8.49e-09 ***\n#> mobile_deviceTRUE  -0.8562     1.2642  -0.677  0.49841    \n#> previous_visit      0.7792     0.2869   2.716  0.00673 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.6 on 996 degrees of freedom\n#> Multiple R-squared:  0.04243,\tAdjusted R-squared:  0.03954 \n#> F-statistic: 14.71 on 3 and 996 DF,  p-value: 2.228e-09\n```\n:::\n\n```{.r .cell-code}\nreg_interaction_model <- lm(purchase_amount ~ chatbot * mobile_device + previous_visit, data = abtest_data)\n\n\nsummary(reg_interaction_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device + previous_visit, \n#>     data = abtest_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -25.403 -14.450  -8.445  12.549  64.562 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                   15.27384    1.19130  12.821  < 2e-16 ***\n#> chatbotTRUE                   -6.82837    1.42580  -4.789 1.93e-06 ***\n#> mobile_deviceTRUE             -0.82375    1.79309  -0.459  0.64605    \n#> previous_visit                 0.77914    0.28711   2.714  0.00677 ** \n#> chatbotTRUE:mobile_deviceTRUE -0.06455    2.52907  -0.026  0.97964    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.6 on 995 degrees of freedom\n#> Multiple R-squared:  0.04243,\tAdjusted R-squared:  0.03858 \n#> F-statistic: 11.02 on 4 and 995 DF,  p-value: 9.485e-09\n```\n:::\n\n```{.r .cell-code}\nggplot(abtest_data, aes(x = chatbot, y = purchase_amount, color = mobile_device)) +\n  geom_boxplot() +\n  labs(title = \"Interaction Effect: Chatbot and Purchase Amount for Mobile Users\", x = \"Chatbot\", y = \"Purchase Amount\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlogistic_model <- glm(purchase ~ chatbot + mobile_device + previous_visit, family = binomial(link = 'logit'), data = abtest_data)\n\n\nsummary(logistic_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot + mobile_device + previous_visit, \n#>     family = binomial(link = \"logit\"), data = abtest_data)\n#> \n#> Coefficients:\n#>                   Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)       -0.22185    0.12347  -1.797  0.07237 .  \n#> chatbotTRUE       -0.96894    0.13564  -7.144 9.09e-13 ***\n#> mobile_deviceTRUE -0.07119    0.14530  -0.490  0.62417    \n#> previous_visit     0.10606    0.03262   3.252  0.00115 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1262.2  on 996  degrees of freedom\n#> AIC: 1270.2\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}